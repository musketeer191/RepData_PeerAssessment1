<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Load and check structure of data</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p>Set the default of echo to be true throughout the document:</p>

<pre><code class="r">library(knitr)
opts_chunk$set(echo = TRUE)
</code></pre>

<h3>Load and check structure of data</h3>

<pre><code class="r">ds &lt;- read.csv(&quot;activity.csv&quot;)
</code></pre>

<pre><code>## Warning: cannot open file &#39;activity.csv&#39;: No such file or directory
</code></pre>

<pre><code>## Error: cannot open the connection
</code></pre>

<pre><code class="r">str(ds)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    17568 obs. of  3 variables:
##  $ steps   : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ date    : Factor w/ 61 levels &quot;2012-10-01&quot;,&quot;2012-10-02&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ interval: int  0 5 10 15 20 25 30 35 40 45 ...
</code></pre>

<h3>What is mean total number of steps taken per day?</h3>

<ol>
<li>Calculate the total number of steps taken per day: we can do this by <code>tapply</code> function</li>
</ol>

<pre><code class="r">res1 &lt;- tapply(ds$steps, ds$date, sum)
</code></pre>

<ol>
<li>Histogram of the total number of steps taken each day</li>
</ol>

<pre><code class="r">hist(res1, xlab = &quot;Total number of steps&quot;, ylab = &quot;Number of days&quot;, 
     main = &quot;Histogram of the total number of steps taken each day&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAllBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OQA5OWU5OY85ZrU5j485j9plAABlADllAGVlOQBlZjllZmVltbVltf2POQCPOTmPOWWPZgCPjzmPj2WPtY+P29qP2/21ZgC1Zjm1tWW124+1/rW1/v3ajzna/rXa/tra/v39tWX924/9/rX9/tr9/v3gGu4LAAAAMnRSTlP/////////////////////////////////////////////////////////////////AA1QmO8AAAAJcEhZcwAACxIAAAsSAdLdfvwAABD7SURBVHic7Z2LeurGGUUjOz3FTesEzskFkraJaROTmove/+WqGY2EBINhZMFG+tf6ToJB0tZoFjO6oMtXOZjkK3UBQAPijYJ4oyDeKIg3CuKNgnijIN4oiDcK4o2CeKMg3iiINwrijYJ4oyDeKIg3CuKNgnijIN4oiDcK4o2CeKMg3iiIN0qv4rezx9c83y0eX8u/KpbzD4RunrKHlyrGZcdGas+h8a5dkFOcij1VkvhsoySX5Yjjwm1nn946BLW4kvjWx8vsI+Lrqd0fJwy159B816f4o+W4YMHSy3LEoMT7v4oWkj2+7hZZlk3yfFW8THM3OHv8oyj5bvHwQ9GC1sXHRTtaZ38tPn8tRqoqqhzfT+0Ws4wpsn9/ynxFuOHluO05hHcht6rsYsL/utKU1ehqrjnHcqivzRAbShcrSR5ZsHljDmFwo2SNshSfzCOT1PNxSxRG91OXJa6WOUT+5MSXY/nFWfuKTeOK4rezzFXV/8qFX7o3xauvi6+fnHg39M9ypLd1VhGWMIx/JD7EhOHTqi72cyjfhZm/7cXX86/F7+cYhhbzqWIbmg9LkscWbJrXGdWs65I1y7Jyag8mmeSNJZ5W8WUF7QtXjnU0Fxe4PFgDXULP4quadMu4eQodkuvuNk/+K//wsnkqKn5VLtekmuzxdZ25CbK5G8V9Vo9/2NUXNeOCfXjdCbbmUE9Rfvtq8dOiZbjZ1uL3c/RDy9KF2H3pjnMPFmw/hZc2rwdXozTK8vvTND+YZF13I40lKuuv+LuYvl7mcqxQffuxJpetqA64onj/zhXJLfza12Px9fR/bMuu/qWayImfhK6w/LQe/1C8t1C312qzrzmHMEWZuxcfJmyI38+xrLqlK12IrcoRK8nBgtVTuI9W2bQeXJVsX5aHv7u37ZlUK+zGElVVMs1bRa9LU74px9otil5zku7q2uv4LLSUU+L9OLX4/dfhpPh2R31SfJXbWMe/xsSXc0wTf7Bgh+LrwVXJ9mUpvxHtSY7EN6ukVfS6NO5NNVa+evjVdSOpXHt3blmLOO7qXd2UFXUs/mRXHyqh1Z9GuvoqNyLeDz0U3+zqy/Er8ZGStBesniJ09fXg6rVZllWj224rrT+tRg81NT0YK1RfNVZkJ/Mirii+/k4uT2zcufKus3iLr8dvis8m+0pYVptj1aDmFNmkyj0SX094ID6kVUP34o9LEluwalssa7TFqmTNsvjy7CdpKG0UrLlR514bY9VzqcZyn3TZubt2Vx+686Jo1e5c0Siq3bmXcnGnYQ3QEl+P3+xgiy3puhKWe+8Hc/DvQu6xeNfh/nTc1Ve7cyG2IT5aksaC1VNUGdXgPFYWv+beT9IQXy9RGN3/UeS0x3Lmvwtf4GqsDqt40SHbdacv6X3Tadu6D1adjo/dXHzY8p/eer5XRyW+43xv3+LXYY05NkTiG8c6k+DXOaMg3iiINwrijYJ4oyDeKIg3CuKNgnijIN4oiDcK4o2CeKMg3iiINwrijYJ4oyDeKIg3CuKNgnijIN4oiDcK4o2CeKMg3iiINwrijYJ4oyDeKIg3CuKNgnijWBCf9Yp6aXrChPi7DROCeGWYEMQrw4QgXhkmBPHKMCGIV4YJQbwyTAjilWFCEK8ME4J4ZZgQxCvDhCBeGSYE8cowIYhXhglBvDJMCOKVYUIQrwwTgnhlmBDEK8OEIF4ZJgTxyjAhiFeGCUG8MkwI4pVhQhCvDBOCeGWYEMQrw4QgXhkmBPHKMCGIV4YJOSt+++U1386y7NPbLYpzFRAf4RLxzn2++fYWxbkKiI9wifjN81vZ8gcK4iOcFz97+O0X1+KfB9vXIz7CBRt3u0U2ydePg23wiI/BVr0yTEgX8UO7DxDiI5wXv3nKHl6iG3dDqQPERzgrfreYF/9NEX+NMCEXHcDJ8+UE8VcIE3JRiy9Yff0N4nsPE3J+Hb+dTd3L6nh/bih1gPgIH9mdG0odID4C4pVhQhCvDBOCeGWYEMQrw4QgXhkmBPHKMCGIV4YJQbwyTAjilWFCEK8ME4J4ZZgQxCvDhCBeGSYE8cowIYhXhglBvDJMCOKVYUIQrwwTgnhlmBDEK8OEIF4ZJgTxyjAhiFeGCUG8MkwI4pVhQhCvDBOCeGWYEMQrw4QgXhkmBPHKMCGIV4YJQbwyTAjilWFCEK8ME4J4ZZgQxCvDhCBeGSYE8cowIYhXhglBvDJMCOKVYUIQrwwTgnhlmBDEK8OEIF4ZJgTxyjAhiFeGCUG8MkwI4pVhQi56/Jgj8qTJodQB4iNc+jCifH38HPGh1AHiI1z4+DEeOHiVMCG0eGWYkEseP8Y6/lphQtiqV4YJ4WnSyjAhPE1aGSaEp0krw4TwNGllmBCeJq0ME8LTpJVhQtidU4YJQbwyTAjilWFCEK8ME4J4ZZgQxCvDhCBeGSYE8cowIYhXhglBvDJMCOKVYUIQrwwTgnhlmBDEK8OEIF4ZJgTxyjAhiFeGCUG8MkwI4pVhQhCvDBOCeGWYEMQrw4QgXhkmBPHKMCGIV4YJCeJXn95WWTZPm3YodYD4CKX47eeX4t/m+PK4dxlKHSA+QhD/5bVo84i/dZiQqqvPHl7WdPW3DhPCxp0yTAjilWFCwjp+Nukw7VDqAPERqha/zvwtjpIYSh0gPkKjq98tEvfkh1IHiI9QiS9vaha5w9E7DKUOEB+hWscf36n2PEOpA8RHYKteGSakPoBz4kbF7zGUOkB8hPpY/XqSrxL36YZSB4iPUB+rL/8lTTuUOkB8hFL87ueX4h8/0tw6TEhYxxfO11k2TZt2KHWA+Ahs1SvDhCBeGSbEiQ9PnWF37uZhQkKLX06L/7E7d+swIfXuXB59+si7DKUOEB8h7M4tprk/1TZp2qHUAeIjhK7e/SSbpZ6MMZQ6QHyEi55J47b+Ir3BUOoA8REuEe/X/ZtvjwYNpQ4QH+ES8ZvnN547d5UwIX4//r2t+e3s4bdfXIt/5qHCvYcJKcX/8Z76YsNvkq95qPAVwoT4rn7JkTtNmJDmAZxL4aHCI4AfaZRhQpoHcFLPtB1KHSA+wtlDtu/8dDeUOkB8hPM/0pRfihhDqQPER7jgR5rt5xMX1Q2lDhAfgXW8MkwIW/XKMCGIV4YJQbwyTAjilWFCuhyyrRhKHSA+Qn0JVYdph1IHiI9Q3RiBX+cUYUJYxyvDhCBeGSZkf+Tu05+nDs2eYih1gPgI9bH6zfPbmgsqbhwmpN6dK8RzCdWtw4Q0WzyXUN06TAi/zinDhLBVrwwTgnhlmBCullWGCeH6eGWYEO6IoQwTwj1wlGFCuOuVMkwIW/XKMCFB/JoWrwgTUt+2vMO0Q6kDxEfgnDtlmJDqCRXTDtMOpQ4QH4FHkyjDhLCOV4YJYR2vDBPCOl4ZJuRez6vP+qTXgvUZJuRej9z1mY34CIhXhgm5267+TrNGJr4kdQsP8QOmKf6eTsRA/JVpio/dqPg9ED9gWuv4edq0iB8wbNUrw4QgXhkm5F7PuUP8lWm0+BXr+FuHCanFb2eJ7R3xg6YSv0p9eHyO+EFT7c4lN/cc8YPGi193aO454gcNW/XKMCHsxyvDhJwXv3k61RsgfsCcFb9blHv3kXuhIX7AXPQY8eZrA8QPGFq8MkzI+XX86dOyED9g2KpXhgnpIv4q56sfzuNOs0yLr0D8gEG8MkzI+d05zUOFEX9lzrd4zUOFEX9lLujqJQ8VRvyVYR2vDBOCeGWYEMQrw4QgXhkmBPHKMCGIV4YJQbwyTAjilWFCEK8ME4J4ZZgQxCvDhCBeGSYE8cowIYhXhglBvDJMCOKVYUIQrwwTgnhlmBDEK8OEIF4ZJgTxyjAhiFeGCUG8MkwI4pVhQhCvDBOCeGWYEMQrw4QgXhkmBPHKMCGIV4YJQbwyTAjilWFCEK8ME4J4ZZgQxCvDhCBeGSYE8cowIYhXhglBvDJMCOKVYUIQrwwTgnhlmBDEK8OEIF4ZJgTxqWG90mfJ0kD8aMLSQPxowtJA/GjC0kD8aMLSQPxowtJA/GjC0kD8aMLSQPxowtJA/GjC0rjo+fHuoYPHTxFH/H2FpXGJeOc+33x7NAjxdxWWxiXiN89vZcsPnDjSfLdHse/X1V2Lnz389otr8c9Hff2h+P5KRYu/Ohds3O0W2SRfHz9TGPH3FZZGj1v1d1sld1swxJ/NvpusOw5LA/GjCUsD8aMJSwPxowlLA/GjCUsD8aMJSwPxowlLA/GjCUsD8aMJSwPxowlLA/GjCUsD8aMJSwPxowlLA/GjCUsD8aMJSwPxowlLA/GjCUsD8aMJSwPxowlLA/GjCUsD8aMJSwPxowlLA/GjCUsD8aMJSwPxowlLA/GjCUsD8aMJSwPxowlLA/GjCUsD8aMJSwPxowlLA/GjCUsD8aMJSwPx0jDd/aIQbzQM8UbDEG80DPFGwxBvNAzxRsMQbzQM8UbDEG80DPFGwxBvNAzxRsMQbzQM8UbDEG80DPFGwxBvNAzxRsMQbzQM8UbDEG807Lz4zZM/hZMHDo4r7Kz43WLuX9fHj5NG/IDDLnqMePPVzSF+Ine/J4lDMv2Kf6fFw4A5v47fzvzXKbKOhwHzka16GDCINwrijYJ4oyDeKIg3CuKNgnijIN4oiDcK4o3So3jxb1MgE99fFL/HXz0M8UbDEG80DPFGwxBvNAzxRsMQbzSMAzhGQbxREG8UxBsF8UZBvFEQbxTEGwXxRkG8UfoSv51lH72OepX5a3JDUvsljc03r4cB3eN8WD9lczcXmfdVshDWtWQ9iXdX0a8mH8tYzhtJ7Zc01q4mojkd4nxYP2Xbfn7JN3976adkIaxzyXoS7+6X4ZtGd3Y/vzSS2i9JQcuHX4spojnpcWVYP2VbOxfLeT8lC2GdS9aT+M3zm/8OfgB/A4Z5ldR+SS1NsdDRnC5xLqy/sp0qUtewziXrSby7UcoHxbt+q/j+hqT2S2pU4Sqa0yXOf4v6KttuMe2vZC6sc8nup8V7lvO7bPF9lW07m+a9lcyHdS7Z/azjPSfWgIkpm/7W8S3xHw3bPLktsZ5KVoZ1LllvW/XTj27Vu/5p98trSGq/JOIWOprTJa5ab3y8bEFVPyULYZ1Ldl/78Q8vPex4X2k//uNlW/nrXeb9lKwK61oyjtwZBfFGQbxREG8UxBsF8UZBvFEQbxTEGwXxRkG8URBvFMQbBfFGQbxREG8UxBsF8UZBvFEQb5Rxid8t/CmI1YmG+1OMz51svJyfHFRkTus3fZxCfh+MS3zeVtOL+NakiL9bSjXbWfb46v9XXk1cfrp5/mf1pvhv9/O/s2y6zlyDXv5YXcD8WAz7x/ePzRB3+nK+zqrEcqTtl3/5AeuBPm95pOKX/hI1d1GJu5r4m9cg/qn62ItfTIpPJn6KZfnp0l+IUF2jUofk5eUvqzCuH2k7+/S2fnwNnw+PcYp3Otw1ZGXHXLwL4kvjdYv31xv6q8xcV7+cu7/qkdsh4VK08FUqBm1nczd1HxcMShin+E15Tbv/e+n64nPi//Pixbtrjh+q70szxN+A4sF3HmEkb7z4vpSfD49xit83Vtcw9139ey1+t/CXHub1Fly728jzauVRjuSmCnclWH/04jEF4xS/Xz2Hq9tb4p2z1WNbfL36rtfq7XW8k7uuNwSKv7aziXsJnyuXuBsjFV9uee8Wj6+rLPvL9/OWeHeh4Xdf2uJ/rC49LPtzHxW28ct3fo3hE8uRtp9/8JMs2aq3xWC36gKI7wjiYZAg3iiINwrijYJ4oyDeKIg3CuKNgnijIN4oiDcK4o2CeKMg3iiINwrijfJ/W8o1R+yrB0oAAAAASUVORK5CYII=" alt="plot of chunk unnamed-chunk-4"/> </p>

<ol>
<li>Mean and median of the total number of steps taken per day (ignoring NAs):</li>
</ol>

<pre><code class="r">mean(res1, na.rm = T)
</code></pre>

<pre><code>## [1] 10766
</code></pre>

<pre><code class="r">median(res1, na.rm = T)
</code></pre>

<pre><code>## [1] 10765
</code></pre>

<h3>What is the average daily activity pattern?</h3>

<ol>
<li>Time series plot of the average number of steps taken in each 5-minute interval, where we average over all days.

<ol>
<li>compute the average for each 5-minute interval</li>
</ol></li>
</ol>

<pre><code class="r">require(plyr)
intervals &lt;- unique(ds$interval)
daily.ds &lt;- ldply(intervals, function(ii) {
  avg.steps &lt;- with(ds, mean(steps[interval == ii], na.rm = T))
  data.frame(&quot;interval&quot; = ii, &quot;avg.steps&quot; = avg.steps)
})
</code></pre>

<ol>
<li>plot the time series</li>
</ol>

<pre><code class="r">require(ggplot2)
pp &lt;- ggplot(data = daily.ds, aes(x = interval, y = avg.steps)) + geom_line(colour = &quot;red&quot;)
pp &lt;- pp + xlab(&quot;Interval&quot;) + ylab(&quot;Average number of steps taken&quot;)
pp
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-7"/> </p>

<ol>
<li>Careful observation of the intervals (their ids actually) show that the ids &gt;= 100 are actually not integers!! They actually have the form hhmm, for example 105 is 1 hour, 5 mins. Thus we need to parse the intervals using <code>lubridate</code> library.</li>
</ol>

<pre><code class="r">require(lubridate)
daily.ds &lt;- transform(daily.ds, parse.interval = hm(interval/100))
</code></pre>

<ol>
<li>We found that the interval containing the maximum number of steps is 8:35AM. This is reasonable since that is the time we go to work.</li>
</ol>

<pre><code class="r">with(daily.ds, parse.interval[which.max(avg.steps)])
</code></pre>

<pre><code>## [1] &quot;8H 35M 0S&quot;
</code></pre>

<h3>Imputing missing values</h3>

<ol>
<li>The total number of missing values in the dataset is:</li>
</ol>

<pre><code class="r">sum(is.na(ds$steps))
</code></pre>

<pre><code>## [1] 2304
</code></pre>

<ol>
<li>We will impute missing values by the mean of the corresponding interval</li>
</ol>

<pre><code class="r">nas &lt;- which(is.na(ds$steps))
full.steps &lt;- numeric(nrow(ds))
full.steps[-nas] &lt;- ds$steps[-nas]
full.steps[nas] &lt;- sapply(nas, function(rr) {
  with(daily.ds, avg.steps[interval == ds$interval[rr]])
})
full.ds &lt;- data.frame(&quot;steps&quot; = full.steps, &quot;date&quot; = ymd(ds$date), &quot;interval&quot; = ds$interval)
</code></pre>

<ol>
<li>After imputing missing values, the new histogram of the total number of steps taken each day:</li>
</ol>

<pre><code class="r">steps.per.day &lt;- tapply(full.ds$steps, full.ds$date, sum)
par(mfrow = c(1, 2))
hist(steps.per.day, xlab = &quot;Total number of steps&quot;, ylab = &quot;Number of days&quot;, 
     main = &quot;Histogram after imputing NAs&quot;, col = &quot;blue&quot;)
hist(res1, xlab = &quot;Total number of steps&quot;, ylab = &quot;Number of days&quot;, 
     main = &quot;Original histogram&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAn1BMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j485j9plAABlADllAGVlOQBlZgBlZjllZmVltbVltf2POQCPOTmPOWWPZgCPjzmPj2WPtY+P27WP29qP2/21ZgC1Zjm1tWW124+1/rW1/tq1/v3ajzna/rXa/tra/v39tWX924/9/rX9/tr9/v0kVyJYAAAANXRSTlP/////////////////////////////////////////////////////////////////////AHy10AoAAAAJcEhZcwAACxIAAAsSAdLdfvwAABN2SURBVHic7Z2LeuO2EUZLu4kjd7uptJsmlbK9rdQklVLr9v7PVgIEKdEiARCDIUHMf742WmvAIYZHvOgC8A9XIJI/TN0BMA0QLxSIFwrECwXihQLxQoF4oUC8UCBeKBAvFIgXCsQLBeKFAvFCgXihQLxQIF4oEC8UiBcKxAsF4oUC8UKBeKFAvFAgXiie4s+r5/31etk876t/1ezW4as+vRZP254M7bV0Uy7Z3+y8KtZVh9V/i0V4N30p11gUL2+3P++61tnP+smqkw+tKJvWg8HiW0/vCkLv9MLhGexLlhpKCVWHy1eY+2VEpVyJonwp+/IgvgVp03oQtserKp/35Z5UqH3pUD4sr3rPev5t9fJ22Tz9WG6BY7UdjsV35fP7spGppHpeL/ztD7cMegfVC5r13S9YrvkXtcpqK51XL//T61bNmlCz/qrDqk/VNj0UP+l1V71m2Yz1UWVX1OX/e6V7W/Wo3U+zYe7E/6pfmvRNO4Ag8fqoVpiNXxZb6Efd2W9eVe9U9Peq0duxqKnqvF/YiK8yLKsMWlwl/ragjhR6qz6Kf79+0+G/6o29rzbsolnxm7XQUE7Veksx27p80zXVo1Y/637cxDcB4qYdgrf4egWqd6bK6nh0etWv3qft6bVc/UHLqc+plT+1QLFWTW7pyqbNoV6nU476FywjS33ersW/6SXNBl2Wr/2Xt2b9JsGvr0vd+vS6MI9M0hVH0/Od6mKxqCpoetTqZ13fnfil7lyUTetLkHj9l+q16l1V8qFYH6t69fFoWy+kercwgureVc/fxJsXrtJ7a9Je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" alt="plot of chunk unnamed-chunk-12"/> </p>

<ol>
<li>Mean total number of steps:</li>
</ol>

<pre><code class="r"># before imputing missing values 
mean(res1, na.rm = T)
</code></pre>

<pre><code>## [1] 10766
</code></pre>

<pre><code class="r"># after imputing missing values 
mean(steps.per.day)
</code></pre>

<pre><code>## [1] 10766
</code></pre>

<p>The <code>mean</code> stays the same.</p>

<ol>
<li>Median total number of steps:</li>
</ol>

<pre><code class="r"># before imputing missing values 
median(res1, na.rm = T)
</code></pre>

<pre><code>## [1] 10765
</code></pre>

<pre><code class="r"># after imputing missing values 
median(steps.per.day)
</code></pre>

<pre><code>## [1] 10766
</code></pre>

<p>The <code>median</code> is slightly increase.</p>

<h3>Are there differences in activity patterns between weekdays and weekends?</h3>

<ol>
<li>Create indicators for weekdays and weekends:</li>
</ol>

<pre><code class="r">full.ds &lt;- transform(full.ds, weekday = weekdays(date))
full.ds &lt;- transform(full.ds, type = ifelse(weekday %in% c(&quot;Saturday&quot;, &quot;Sunday&quot;), &quot;weekend&quot;, &quot;weekday&quot;))
</code></pre>

<ol>
<li></li>
</ol>

<pre><code class="r">require(dplyr)
interval_full &lt;- full.ds %&gt;% group_by(interval, type) %&gt;% summarise(avg.steps = mean(steps))
p2 &lt;- ggplot(data = interval_full, aes(x = interval, y = avg.steps, colour = type)) + geom_line() + 
    facet_wrap(~ type, ncol = 1, nrow=2) + theme(legend.position=&quot;none&quot;)

p2 &lt;- p2 + xlab(&quot;Interval&quot;) + ylab(&quot;Avg. number of steps taken&quot;)
p2
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-16"/> </p>

</body>

</html>
